!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("gqless")):"function"==typeof define&&define.amd?define(["exports","react","gqless"],t):t((e=e||self).gqlessHook={},e.react,e.gqless)}(this,function(e,t,n){var r="undefined"==typeof window||/ServerSideRendering/.test(window.navigator&&window.navigator.userAgent)?function(e){return e()}:t.useLayoutEffect,u=new WeakMap,c=function(e){try{return null!==e&&"object"==typeof e&&!!n.getAccessor(e)}catch(e){return!1}},o={get:function(e,t){var n=Reflect.get(e,t);return"function"==typeof n&&Array.isArray(e)?Array.prototype[t].bind(f(e)):"function"==typeof n||c(n)?f(n):n},apply:function(e,t,n){var r=Reflect.apply(e,t,n);return"function"==typeof r||c(r)?f(r):r}},f=function(e){var t=u.get(e);return t||(t=new Proxy(e,o),u.set(e,t)),t},i=process.env.EXPERIMENTAL_USE_CLENAUP_FOR_CM?function(){var e=t.useRef([]),n=t.useCallback(function(t){var n=setTimeout(t,5e3);e.current.push({timer:n,func:t})},[]);return t.useEffect(function(){var t=e.current;return t.forEach(function(e){return clearTimeout(e.timer)}),function(){t.forEach(function(e){return(0,e.func)()})}},[]),n}:function(){var e=t.useRef([]),n=t.useCallback(function(t){e.current.push(t)},[]);return t.useEffect(function(){var t=e.current;return function(){t.forEach(function(e){return e()})}},[]),n};e.useQuery=function(e){var c=i(),a=t.useReducer(function(e){return e+1},0)[1],s=t.useRef(!1);if(s.current)throw new Promise(function(t){e.scheduler.commit.onFetched.then(function(){s.current=!1,t()})});r(function(){e.scheduler.commit.accessors.size>0&&(s.current=!0,a())});var p=t.useRef(new Map),d=t.useCallback(function(e){var t=p.current.get(e);t||p.current.set(e,t=function(){!function e(t){if("object"==typeof t.data){var n=new Proxy(t.data,o);u.set(t.data,n)}t.parent&&e(t.parent)}(e),s.current||a()}),c(e.onDataChange(t))},[c]);n.accessorInterceptors.add(d);var l=setTimeout(function(){n.accessorInterceptors.delete(d)},5e3);return t.useEffect(function(){clearTimeout(l),n.accessorInterceptors.delete(d)}),f(e.query)}});
//# sourceMappingURL=index.umd.js.map
